import pandas as pd

countries = {
    "Україна": {
        "Площа": "603 548 км²",
        "Населення": "36 млн осіб",
        "Частина світу": "Європа"
    },
    "Франція": {
        "Площа": "551 695 км²",
        "Населення": "68 млн осіб",
        "Частина світу": "Європа"
    },
    "Канада": {
        "Площа": "9 984 670 км²",
        "Населення": "40 млн осіб",
        "Частина світу": "Північна Америка"
    },
    "Бразилія": {
        "Площа": "8 515 767 км²",
        "Населення": "216 млн осіб",
        "Частина світу": "Південна Америка"
    },
    "Китай": {
        "Площа": "9 596 961 км²",
        "Населення": "1,41 млрд осіб",
        "Частина світу": "Азія"
    },
    "Японія": {
        "Площа": "377 975 км²",
        "Населення": "125 млн осіб",
        "Частина світу": "Азія"
    },
    "Єгипет": {
        "Площа": "1 001 449 км²",
        "Населення": "113 млн осіб",
        "Частина світу": "Африка"
    },
    "Австралія": {
        "Площа": "7 692 024 км²",
        "Населення": "27 млн осіб",
        "Частина світу": "Австралія"
    },
    "США": {
        "Площа": "9 833 520 км²",
        "Населення": "341 млн осіб",
        "Частина світу": "Північна Америка"
    },
    "Німеччина": {
        "Площа": "357 588 км²",
        "Населення": "84 млн осіб",
        "Частина світу": "Європа"
    }
}

df = pd.DataFrame.from_dict(countries, orient='index')
print("\n=== DataFrame ===")
print(df)

def parse_area(value):
    return int(value.replace(" км²", "").replace(" ", ""))

def parse_population(value):
    value = value.replace(" осіб", "")
    value = value.replace(" млн", "000000")
    value = value.replace(" млрд", "000000000")
    value = value.replace(",", ".")
    return float(value)

df["Площа_км2"] = df["Площа"].apply(parse_area)
df["Населення_осіб"] = df["Населення"].apply(parse_population)
df["Дохід_на_особу"] = [6000, 42000, 52000, 9500, 13000, 39000, 3500, 54000, 65000, 48000]

print("\n=== Перші 3 рядки ===")
print(df.head(3))
print("\n=== Типи даних ===")
print(df.dtypes)
print("\n=== Кількість рядків і стовпців ===")
print(df.shape)
print("\n=== Описова статистика ===")
print(df.describe())
df["Оцінка_ВВП"] = df["Населення_осіб"] * df["Дохід_на_особу"]
print("\n=== DataFrame з новим стовпцем Оцінка_ВВП ===")
print(df)
filtered = df[df["Дохід_на_особу"] > 10000]
print("\n=== Фільтрація (дохід > 10000) ===")
print(filtered)
sorted_df = df.sort_values(by="Дохід_на_особу", ascending=False)
print("\n=== Сортування за спаданням доходу ===")
print(sorted_df)
grouped = df.groupby("Частина світу")["Дохід_на_особу"].mean()
print("\n=== Середній дохід на особу по частинах світу ===")
print(grouped)
max_gdp = df.groupby("Частина світу")["Оцінка_ВВП"].max()
print("\n=== Максимальний ВВП у категорії ===")
print(max_gdp)
unique_count = df.index.nunique()
print("\n=== Кількість унікальних країн ===")
print(unique_count)
